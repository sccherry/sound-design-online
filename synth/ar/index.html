<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>[AR] Arpeggiator | Sound Design Online</title>
    <meta
      name="description"
      content="Pattern Pattern up down upDown downUp alternateUp alternateDown random randomOnce randomWalk Interval 4n 8n 16n Transport BPM 120 State Oscillator Type sine..."
    />

    <link rel="icon" href="/sound-design-online/public/img/favicon.ico" size="any" />
    <link
      rel="icon"
      href="/sound-design-online/public/img/icon.svg"
      type="image/svg+xml"
    />
    <link
      rel="apple-touch-icon"
      href="/sound-design-online/public/img/apple-touch-icon.png"
    />
    <link
      rel="apple-touch-startup-image"
      href="/sound-design-online/public/img/icon-512.png"
    />
    <meta name="apple-mobile-web-app-title" content="Sound Design Online" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <link rel="manifest" href="/sound-design-online/site.webmanifest" />
    <meta name="theme-color" content="#000000" />

    <link rel="canonical" href="https://stevecherry.net/sound-design-online/synth/ar/" />

    <link
      rel="stylesheet"
      href="https://stevecherry.net/normcore/css/normcore.css"
    />
    <link rel="stylesheet" href="/sound-design-online/public/style.css" media="screen" />

    <script
      src="https://stevecherry.net/normcore/js/normcore.js"
      defer
    ></script>
    <script src="/sound-design-online/public/script.js" type="module"></script>
  </head>
  <body>
    <div class="container cover stack">
      <header role="banner">
        <a href="/sound-design-online/">Sound Design Online</a>
      </header>

      <main class="flex-1 stack" role="main">
        <h1>[AR] Arpeggiator</h1>

        



<div class="grid">
  
  
      <fieldset id="pattern">
        <legend>Pattern</legend>
        
    
  
      <label class="block" for="pattern-pattern">Pattern</label>
      
    <select id="pattern-pattern" name="pattern-pattern" value="up">
      
        <option value="up" selected>up</option>
      
        <option value="down">down</option>
      
        <option value="upDown">upDown</option>
      
        <option value="downUp">downUp</option>
      
        <option value="alternateUp">alternateUp</option>
      
        <option value="alternateDown">alternateDown</option>
      
        <option value="random">random</option>
      
        <option value="randomOnce">randomOnce</option>
      
        <option value="randomWalk">randomWalk</option>
      
    </select>
  
    

    
  
      <label class="block" for="pattern-interval">Interval</label>
      
    <select id="pattern-interval" name="pattern-interval" value="8n">
      
        <option value="4n">4n</option>
      
        <option value="8n" selected>8n</option>
      
        <option value="16n">16n</option>
      
    </select>
  
    

  
      </fieldset>
    

  
  
      <fieldset id="transport">
        <legend>Transport</legend>
        
    
  
      <label class="block" for="transport-bpm">BPM</label>
      
    <input-output>
      <input type="range" id="transport-bpm" name="transport-bpm" data-target="input-output.input" min="60" max="220" step="1" value="120">
      <output for="transport-bpm" data-target="input-output.output">120</output>
    </input-output>
  
    

    
  <label class="block" for="transport-state">
    <input type="checkbox" id="transport-state" name="transport-state"  checked>
    State
  </label>

  
      </fieldset>
    

  
  
  

  
      <fieldset id="synth-oscillator">
        <legend>Oscillator</legend>
        
    
  
      <label class="block" for="synth-oscillator-type">Type</label>
      
    <select id="synth-oscillator-type" name="synth-oscillator-type" value="sine">
      
        <option value="sine" selected>sine</option>
      
        <option value="triangle">triangle</option>
      
        <option value="square">square</option>
      
        <option value="sawtooth">sawtooth</option>
      
    </select>
  
    

    
    
  
  
  
  
  

  
      <fieldset id="synth-oscillator-detune">
        <legend>Detune</legend>
        
    
  
      <label class="block" for="synth-oscillator-detune-octave">Octave</label>
      
    <input-output>
      <input type="range" id="synth-oscillator-detune-octave" name="synth-oscillator-detune-octave" data-target="input-output.input" min="-3600" max="3600" step="1200" value="0">
      <output for="synth-oscillator-detune-octave" data-target="input-output.output">0</output>
    </input-output>
  
    

    
  
      <label class="block" for="synth-oscillator-detune-coarse">Coarse</label>
      
    <input-output>
      <input type="range" id="synth-oscillator-detune-coarse" name="synth-oscillator-detune-coarse" data-target="input-output.input" min="-1200" max="1200" step="100" value="0">
      <output for="synth-oscillator-detune-coarse" data-target="input-output.output">0</output>
    </input-output>
  
    

    
  
      <label class="block" for="synth-oscillator-detune-fine">Fine</label>
      
    <input-output>
      <input type="range" id="synth-oscillator-detune-fine" name="synth-oscillator-detune-fine" data-target="input-output.input" min="-100" max="100" step="1" value="0">
      <output for="synth-oscillator-detune-fine" data-target="input-output.output">0</output>
    </input-output>
  
    

  
      </fieldset>
    

    
  
      <label class="block" for="synth-oscillator-phase">Phase</label>
      
    <input-output>
      <input type="range" id="synth-oscillator-phase" name="synth-oscillator-phase" data-target="input-output.input" min="-180" max="180" step="1" value="0">
      <output for="synth-oscillator-phase" data-target="input-output.output">0</output>
    </input-output>
  
    

  
      </fieldset>
    

  
  
  

  
      <fieldset id="synth-suboscillators-0">
        <legend>Suboscillator</legend>
        
    
  
      <label class="block" for="synth-suboscillators-0-type">Type</label>
      
    <select id="synth-suboscillators-0-type" name="synth-suboscillators-0-type" value="square">
      
        <option value="sine">sine</option>
      
        <option value="triangle">triangle</option>
      
        <option value="square" selected>square</option>
      
        <option value="sawtooth">sawtooth</option>
      
    </select>
  
    

    
    
  
  
  
  
  

  
      <fieldset id="synth-suboscillators-0-detune">
        <legend>Detune</legend>
        
    
  
      <label class="block" for="synth-suboscillators-0-detune-octave">Octave</label>
      
    <input-output>
      <input type="range" id="synth-suboscillators-0-detune-octave" name="synth-suboscillators-0-detune-octave" data-target="input-output.input" min="-3600" max="3600" step="1200" value="-1200">
      <output for="synth-suboscillators-0-detune-octave" data-target="input-output.output">-1200</output>
    </input-output>
  
    

    
  
      <label class="block" for="synth-suboscillators-0-detune-coarse">Coarse</label>
      
    <input-output>
      <input type="range" id="synth-suboscillators-0-detune-coarse" name="synth-suboscillators-0-detune-coarse" data-target="input-output.input" min="-1200" max="1200" step="100" value="0">
      <output for="synth-suboscillators-0-detune-coarse" data-target="input-output.output">0</output>
    </input-output>
  
    

    
  
      <label class="block" for="synth-suboscillators-0-detune-fine">Fine</label>
      
    <input-output>
      <input type="range" id="synth-suboscillators-0-detune-fine" name="synth-suboscillators-0-detune-fine" data-target="input-output.input" min="-100" max="100" step="1" value="0">
      <output for="synth-suboscillators-0-detune-fine" data-target="input-output.output">0</output>
    </input-output>
  
    

  
      </fieldset>
    

    
  
      <label class="block" for="synth-suboscillators-0-phase">Phase</label>
      
    <input-output>
      <input type="range" id="synth-suboscillators-0-phase" name="synth-suboscillators-0-phase" data-target="input-output.input" min="-180" max="180" step="1" value="0">
      <output for="synth-suboscillators-0-phase" data-target="input-output.output">0</output>
    </input-output>
  
    

  
      </fieldset>
    

  
  
      <fieldset id="synth-envelope">
        <legend>Envelope</legend>
        
    
  
      <fieldset id="synth-envelope-envelope">
        <legend>Envelope</legend>
        
    
  
      <label class="block" for="synth-envelope-envelope-attack">Attack</label>
      
    <input-output>
      <input type="range" id="synth-envelope-envelope-attack" name="synth-envelope-envelope-attack" data-target="input-output.input" min="0" max="1" step="0.001" value="0.005">
      <output for="synth-envelope-envelope-attack" data-target="input-output.output">0.005</output>
    </input-output>
  
    

    
  
      <label class="block" for="synth-envelope-envelope-decay">Decay</label>
      
    <input-output>
      <input type="range" id="synth-envelope-envelope-decay" name="synth-envelope-envelope-decay" data-target="input-output.input" min="0" max="1" step="0.001" value="0.7">
      <output for="synth-envelope-envelope-decay" data-target="input-output.output">0.7</output>
    </input-output>
  
    

    
  
      <label class="block" for="synth-envelope-envelope-sustain">Sustain</label>
      
    <input-output>
      <input type="range" id="synth-envelope-envelope-sustain" name="synth-envelope-envelope-sustain" data-target="input-output.input" min="0" max="1" step="0.001" value="0.005">
      <output for="synth-envelope-envelope-sustain" data-target="input-output.output">0.005</output>
    </input-output>
  
    

    
  
      <label class="block" for="synth-envelope-envelope-release">Release</label>
      
    <input-output>
      <input type="range" id="synth-envelope-envelope-release" name="synth-envelope-envelope-release" data-target="input-output.input" min="0" max="1" step="0.001" value="0.3">
      <output for="synth-envelope-envelope-release" data-target="input-output.output">0.3</output>
    </input-output>
  
    

  
      </fieldset>
    

  
      </fieldset>
    

</div>


  
  
      <label class="block" for="piano-mode">Mode</label>
      
    <select id="piano-mode" name="piano-mode" value="toggle">
      
        <option value="button">button</option>
      
        <option value="toggle" selected>toggle</option>
      
        <option value="impulse">impulse</option>
      
    </select>
  
    

  <div id="piano-piano"></div>


<script type="module">
  import { Midi, Pattern, Transport, start } from 'https://cdn.skypack.dev/tone';
  import { createAmplitudeEnvelope, createOmniOscillator, createPattern, createPiano, createTransport, MultiSynth } from '../../public/lib/nexus-tone-components.js';

  const options = {"synth":{"oscillator":{"type":"sine"},"envelope":{"attack":0.005,"decay":0.7,"sustain":0.005,"release":0.3},"suboscillators":[{"type":"square","detune":-1200}]},"pattern":{"interval":"8n"},"transport":{"state":true}};

  const synth = new MultiSynth(options.synth).toDestination();

  const pattern = new Pattern((time, note) => {
    synth.triggerAttackRelease(note, pattern.interval, time);
  }, [], options.pattern.pattern);

  pattern.interval = options.pattern.interval;

  if (options.transport.bpm) {
    Transport.bpm.value = options.transport.bpm;
  }

  const values = new Set();

  const onMidi = ([status, data0, data1]) => {
    const message = Math.floor(status / 16);
    const channel = status % 16;

    switch (message) {
      // note on
      case 9: {
        const freq = Midi(data0).toFrequency();
        values.add(freq);
        pattern.values = Array.from(values).sort();
        if (pattern.values.length === 1) pattern.start();
        break;
      }
      // note off
      case 8: {
        const freq = Midi(data0).toFrequency();
        values.delete(freq);
        pattern.values = Array.from(values).sort();
        if (pattern.values.length === 0) pattern.stop();
        break;
      }
    }
  };

  createPattern('#pattern', value => {
    Object.keys(value).forEach(key => {
      pattern[key] = value[key];
    });
  });

  createTransport('#transport', value => {
    Object.keys(value).forEach(key => {
      switch (key) {
        case 'bpm': {
          Transport.bpm.value = value[key];
          break;
        }
        case 'state': {
          if (value[key]) {
            Transport.start();
          } else {
            Transport.stop();
          }
          break;
        }
      }
    });
  });

  createOmniOscillator('#synth-oscillator', value => {
    synth.set({ oscillator: value });
  });

  createOmniOscillator('#synth-suboscillators-0', value => {
    synth.set({ suboscillators: { 0: value } });
  });

  createAmplitudeEnvelope('#synth-envelope', value => {
    synth.set({ envelope: value });
  });

  createPiano('#piano', onMidi);

  document.addEventListener('click', async () => {
    await start();

    if (options.transport.state) {
      Transport.start();
    }

    console.log('audio context resumed');
  }, { once: true });
</script>

      </main>

      <footer role="contentinfo">
        <p>Creating Sounds for Electronic Music using web audio.</p>
      </footer>
    </div>

    <script defer>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/sound-design-online/sw.js', {
          scope: '/sound-design-online/',
        });
      }
    </script>
  </body>
</html>
